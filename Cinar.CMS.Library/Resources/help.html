<html>
    <head>
        <style>
            body {
                font-family: Tahoma, Arial, sans-serif;
	            font-size: 14px;
	            letter-spacing: normal;
	            line-height:normal;
                color: rgb(80, 80, 80);
            }
            h1 {
                font-size: 18px;
                border-bottom: 1px solid rgba(33, 74, 133, 0.22);
                font-weight: normal;
                color: #214A85;
            }
            h2 {
                font-size:16px;
                font-weight: normal;
            }
            h3 {
                font-weight: normal;
                font-size:14px;
            }
            pre {
                font-family: Lucida Console;
                font-size: 11px;
                border: 1px dashed rgb(218, 218, 218);
                background: #fffff5;
                padding: 8px;
                margin-left: 32px;
            }
            .part {
                margin-left:20px;
            }
            div.codeSample {
                position:relative;
            }
            button {
                right: 0px;
                position: absolute;
                bottom: 0px;
            }
            b {
                font-weight: normal;
                color: #316AC5;
            }
            b.btn {
                cursor: pointer;
            }
            ul {
                margin: 0px;
            }
        </style>
        <script type="text/javascript" src="/external/javascripts/prototype.js"></script>
        <script>
            document.observe('dom:loaded', function () {
                $$('.part').each(Element.hide);
                $$('.part').first().show();

                $$('h1').each(function (h1) { h1.observe('click', toggle); });
            });

            function toggle(event) {
                $$('.part').each(Element.hide);
                $(Event.element(event)).next().show();
            }

            function execute(btn) {
                window.parent.eval($(btn).up().previous('pre.code').innerText);
            }
        </script>
    </head>
<body>

    <h1>Çınar CMS Bileşenleri</h1>
    <div class="part">
        <ol>
            <li>Bilginin gösterimi için <b>Sayfa</b>lar ve <b>Modül</b>ler</li>
            <li>Bilginin saklanması için <b>Kategori</b>ler ve <b>İçerik</b>ler</li>
            <li>Bilgiyi detaylandırmak için <b>Yazar</b>lar, <b>Kaynak</b>lar, <b>Etiket</b>ler</li>
            <li>Etkileşim için <b>Kullanıcı</b>lar, <b>Yorum</b>lar, <b>Mesaj</b>lar</li>
            <li>Kodlama için <b>Çınar Script</b></li>
            <li>Genel <b>Javascript</b> ve <b>CSS</b> dosyaları</li>
            <li>Javascript nesne ve fonksiyonları</li>
            <li>Performans için <b>Önbellek</b> (cache) çözümü</li>
        </ol>
    </div>
    <h1>Sayfalar ve Modüller</h1>
    <div class="part">
        <ul>
            <li>Çınar CMS'de tüm bilgiler veritabanında tutulur, fiziksel sayfalar yoktur</li>
            <li>Sitenize dilediğiniz kadar sayfa ekleyebilirsiniz. Bu sayfalar görünürde .aspx uzantılı dosya gibidirler.</li>
            <li>Default.aspx isimli sayfa kurulumda otomatik oluşturulur.</li>
            <li>Default.aspx'in kaynak kodunu görmek için <b class="btn" onclick="window.parent.editTemplate('Default.aspx')">tıklayınız</b>.</li>
            <li>
                Sayfa kodu aşağıdaki gibidir:
                <pre class="code">&lt;html&gt;
&lt;head&gt;
$=this.HeadSection$
&lt;/head&gt;
&lt;body&gt;
    &lt;div id="page"&gt;
        &lt;div id="Header" class="Region"&gt;$=this.Header$&lt;/div&gt;
        &lt;div id="Content" class="Region"&gt;$=this.Content$&lt;/div&gt;
        &lt;div id="Footer" class="Region"&gt;$=this.Footer$&lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
            </li>
            <li>Bu sayfayı dilediğiniz gibi düzenleyebilirsiniz.</li>
            <li>Çınar CMS'de sayfalar bölgelerden (region), bölgeler de modüllerden oluşur.</li>
            <li>Sayfa kodunda görülen, class'ı Region olan divlerin içindeki $=this.Content$ gibi ifadeler Çınar Script kodudur.</li>
            <li>$=this.Content$ ifadesi Content bölgesinin modüllerini yükleyip gösterir.</li>
            <li>Sitenize yeni sayfa eklemek için;
                <ul>
                    <li>sayfanın herhangi bir yerine sağ tıklayın</li>
                    <li>açılan menüden <b>Sayfa Ekle</b>'yi seçin</li>
                    <li>Sayfanın adını soran bir pencere açılacak, oraya YeniSayfa.aspx ismini girin.</li>
                    <li>Yeni sayfanızın kodunu gösteren pencere açılacak, Kaydet'e basın.</li>
                    <li>Sayfanız oluşturuldu.</li>
                    <li>Görmek için adresin sonuna YeniSayfa.aspx yazabilir ya da sağ tıklayıp, diğer sayfalar menüsünden YeniSayfa.aspx'i seçebilirsiniz.</li>
                </ul></li>
            <li>Modüller bölgenin üzerine sağ tıklayarak Modül Ekle menüsünden eklenir.</li>
            <li>Örneğin Footer bölgesine yeni bir modül eklemek için;
                <ul>
                    <li>Footer bölgesine sağ tıklayın</li>
                    <li>açılan menüden <b>Modül Ekle</b> > <b>Çeşitli</b> > <b>Statik HTML</b>'i seçin.</li>
                    <li>modül derhal sayfaya eklenecek ve modülü düzenleme formu açılacaktır.</li>
                    <li>Açılan pencerede HTML Kodu alanına yazı girebilirsiniz.</li>
                    <li>Bu modülün görevi girdiğiniz html kodunu göstermektir.</li>
                </ul>
            </li>
        </ul> 
    </div>
    <h1>Kategoriler ve İçerikler</h1>
    <div class="part">
        <ul>
        <li>Sayfalar, sayfaların içindeki bölgeler ve bölgelerin içindeki modüllerin amacı, siteye ait içerikleri göstermektir.</li>
        <li>Site içerikleri; "kategori > alt kategori > alt kategori... > içerik" şeklinde hiyerarşik yapıdadır.</li>
        <li>En üst kategorinin adı "Kök"dür.</li>
        <li>Bu sitenin kategori ve içerik hiyerarşisini görmek için <b class="btn" onclick="window.parent.openTree()">tıklayınız</b>.</li>
        <li>Kategori-İçerik Ağacı penceresi açılacaktır. Sayfalarınıza sağ tıklayıp menüden "Kategori-İçerik Ağacı"nı seçerek bu pencereye her zaman ulaşabilirsiniz.</li>
        <li>Bu ağaç görünümünde 
            <ul>
                <li>bir kategoriye tıklarsanız, o kategorinin altındaki içerik ve kategorileri listeleyen pencere açılacaktır</li>
                <li>bir içeriğe tıklarsanız, o içeriğin bilgilerini düzenlemek için form açılacaktır.</li>
            </ul></li>
        <li>Aslında içerik ve kategori birbiriyle tamamen aynı özelliklere sahiptir.</li>
        <li>Bütün içeriklerin;
            <ul>
                <li>Başlığı (Title)</li>
                <li>Yayınlanma Tarihi (PublishDate)</li>
                <li>Açıklaması ya da özeti (Description)</li>
                <li>İçerik metni (Metin)</li>
                <li>Resmi (Picture)</li>
                <li>Keywords'ü (arama motorları için)</li>
                <li>Yazarı (Author)</li>
                <li>Kaynağı (Source)</li>
            </ul>
            vardır.
        </li>
        </ul>
    </div>
    <h1>Yazarlar, Kaynaklar ve Etiketler</h1>
    <div class="part">
        <ul>
            <li>İçerik için yazar girilmesi bazen gerekli olur. (Özellikle haber sitelerinde, akademik sitelerde)</li>
            <li>Yazarları eklemek ve düzenlemek için
                <ul>
                    <li>Sağ tık menüyü açın.</li>
                    <li>Veri > Yazar menüsünü seçin</li>
                    <li>Yazarların listelendiği bir pencere açılacak.</li>
                    <li>Tüm veri türleri için bu şekilde liste pencerelerini açabilirsiniz.</li>
                    <li>Listeden bir satıra (yazara) tıklayıp, sağ alt köşedeki butonlarla işleminizi gerçekleştirebilirsiniz.</li>
                    <li>Yeni yazar eklemek için + butonuna tıklayın.</li>
                    <li>Açılan pencerede yazarın ismini, ünvanını girin.</li>
                    <li>Resim seçin. Dilerseniz bir resmin url adresini de yazabilirsiniz. Kaydetme işlemi sırasında resim webden indirilir ve UserFiles/Images/_author klasörüne kaydedilir.</li>
                    <li>Kaydet'e tıklayın. Yeni yazarınız kaydedildi.</li>
                    <li>Artık bu yazarı içerik girerken seçebilirsiniz.</li>
                </ul>
            </li>
            <li>Kaynaklar da aynı yazarlar gibi eklenir.</li>
            <li>Kaynak içeriğin ait olduğu kurumu, gazeteyi vb. belirtir.</li>
        </ul>
    </div>
    <h1>Kullanıcılar ve Üyelik modülleri</h1>
    <div class="part">
        <ul>
            <li>
                Çınar CMS ilk çalıştırıldığında 3 tane otomatik kullanıcı ekler
                <ul>
                    <li><b>Admin</b>: En yetkili kullanıcıdır (Roller: Designer, Editor, User)</li>
                    <li><b>Editör</b>: Yönetim paneline girebilen kullanıcıdır (Roller: Editor, User)</li>
                    <li><b>Anonim</b>: Henüz üye olmamış ziyaretçiler bu kullanıcı hesabında sayılır (Roller: yok)</li>
                </ul>
            </li>
            <li>
                Roller ile kullanıcıların yetkileri belirlenir:
                <ul>
                    <li><b>Designer</b>: Bu rol tasarım modunda çalışma imkanı sağlar.</li>
                    <li><b>Editör</b>: Yönetim paneline erişebilmek için kullanıcının bu role sahip olması gerekir.</li>
                    <li><b>User</b>: Siteye üye olan kullanıcılar otomatik olarak bu role sahip olur.</li>
                    <li>Kullanıcılarınıza bunlar dışında, dilediğiniz isimde rol atayabilirsiniz.</li>
                    <li>Bazı modülleri sadece belli role sahip kullanıcıların görmesini sağlayabilirsiniz.</li>
                    <li>"Sayfa Güvenliği" isimli modülü ekleyerek bir sayfanın sadece belli role sahip kullanıcılara gösterilmesini sağlayabilirsiniz.</li>
                </ul>
            </li>
            <li>
                Kullanıcı listesini almak ve kullanıcı bilgilerini düzenlemek için Veri > Kullanıcı menüsünü seçiniz.
                <ul>
                    <li>Kullanıcılara rolleri virgüllerle ayrılmış kelimeler şeklinde ekleyebilirsiniz.</li>
                    <li>Üye olan ziyaretçinin email adresine onay mesajı gönderilir.</li>
                </ul> 
            </li>
            <li>
                Kullanıcılarla ilgili modülleri eklemek için Modül Ekle > Üyelik > altındaki modüllerden birini seçiniz. Bunlar:
                <ul>
                    <li><b>Üyelik Formu</b>: Ziyaretçiler bu formu doldurarak siteye üye olur. Formda varsayılan olarak bütün alanlar vardır, dilerseniz tasarımını değiştirebilir, alanları azaltabilirsiniz.</li>
                    <li><b>Login Formu</b>: Bu form ile ziyaretçiler sitede oturum açarlar.</li>
                    <li><b>Şifre Hatırlat Formu</b>: Bu forma ziyaretçi email adresini girer, email adresine şifre hatırlatma yönergesi gönderilir.</li>
                    <li>Login Formu modülünde "Şifremi hatırlat", "Üye olmak istiyorum" gibi linkler vardır.</li>
                    <li>Login Formu, oturum açıldıktan sonra hoşgeldiniz mesajı görüntüler ve kullanıcının yetkisine göre uygun linkler gösterir. Örneğin Designer rolüne sahip kullanıcıya "Tasarım Modu" linki, Editor rolüne sahip kullanıcıya "Yönetim Paneli" linki gösterilir.</li>
                </ul>
            </li>
        </ul>
    </div>
    <h1>Çınar Script ile geliştirme ve Provider nesnesi</h1>
    <div class="part">
        <ul>
            <li>Siteyi oluşturan sayfaların kaynak koduna, Statik HTML ve Data List modüllerine Çınar Script ile kod yazabilirsiniz.</li>
            <li>Çınar Script DotNet frameworkü üzerinde çalışır ve C#'a çok benzer.</li>
            <li>Kodun başladığı ve bittiği yer $ işareti ile belirtilir. Örneğin;
                <pre>$
for(int i=0; i<100; i++) 
    echo("&lt;b>" + i + "&lt;/b>");
$</pre></li>
            <li>$=DateTime.Now$ ifadesi çıktıya yazdırmanın (yani echo fonksiyonunun) kısa yoludur.</li>
            <li>Siteyle ilgili bağlama (context'e) Provider nesnesi üzerinden erişebilirsiniz. Provider veritabanına, Request, Response nesnelerine, ve bunun gibi pek çok bağlama erişmenizi sağlar:
                <pre>&lt;b>Son içerik ve bazı bilgiler:&lt;/b>
$ 
    var lastContentId =  Provider.Database.GetInt("select max(Id) from Content");

    var userName = Provider.User.Name;
    var currentContentTitle = Provider.Content.Title;
    var currentCategoryTitle = Provider.Content.Category.Title;

    if(Provider.User.IsInRole("Editor"))
        echo("Yönetim paneline gitmek için tıklayınız.");

    string siteAdi = Provider.Configuration.SiteName;
    int oncekiIcerikId = Provider.PreviousContentId;
    int sonrakiIcerikId = Provider.NextContentId;

    string thumbImageSrc = Provider.GetThumbPath("/UserFiles/Images/logo.png", 320, 0, false);

    string aWebConfigSetting = Provider.AppSettings["aWebConfigSetting"];
    object sessionData = Provider.Session["data"];

    // gibi daha pek çok metod ve özellik (detaylı bilgi için referanslara bakınız)
$</pre>
            </li>
            <li>Deneme yapmak için şu adımları izleyiniz:
                <ul>
                    <li>Herhagi bir bölgeye sağ tıklayın ve menüden Modül Ekle > Çeşitli > Statik HTML seçiniz.</li>
                    <li>Statik HTML modülü o bölgenin sonuna eklenecek ve düzenleme penceresi açılacaktır.</li>
                    <li>Bu pencerede HTML Kodu alanına şu kodu girin:
                        <pre>$
for(int i=0; i<100; i++) 
    echo(i + ",");
$
&lt;br />
&lt;br />
Tarih: $=DateTime.Now.ToString("dd.MM.yyyy")$

</pre>
                    </li>
                    <li>Kaydet'e tıkladığınızda modülün içinde kod çıktısı gösterilecektir.</li>
                </ul>
            </li>
        </ul>
    </div>
    <h1>Genel ayarlar, genel Javascript ve CSS dosyaları</h1>
    <div class="part">
        <ul>
            <li>Sitenin SEO bilgileri, runtime ayarları, mail hesabı bilgileri gibi ayarlar Konfigürasyon penceresinden yapılır.</li>
            <li>Sağ tık menüden Konfigürasyon menüsünü seçip bu ayarları yapabilirsiniz.</li>
            <li><b>Genel Javascript Kodu</b> ve <b>Genel CSS Ayarları</b> menülerinden sitenin javascripti kodlarını ve CSS kodlarını düzenleyebilirsiniz.</li>
        </ul>
    </div>
    <h1>Client nesne ve metodları</h1>
    <div class="part">
        <h2>Liste Formları</h2>
        <div class="codeSample">
        <h3>Open entity list form</h3>
        <pre class="code">openEntityListForm({
        entityName: 'Content', 
        caption: 'Content List'
    });</pre>
        <div align="right"><button onclick="execute(this)">Execute</button></div>
        </div>
    
        <div class="codeSample">
        <h3>Open entity list form with filter</h3>
        <pre class="code">openEntityListForm({
        entityName: 'Content', 
        caption: 'Content List',
        extraFilter: 'CategoryId=1'
    });</pre>
        <div align="right"><button onclick="execute(this)">Execute</button></div>
        </div>
    
        <div class="codeSample">
        <h3>Open entity list form to select an entity</h3>
        <pre class="code">openEntityListForm({
        entityName: 'Content', 
        caption: 'Content List',
        extraFilter: 'CategoryId=1',
        selectCallback: function(entityId){
            Windows.getFocusedWindow().close(); // first close list form
            alert('You selected: ' + entityId);
        }
    });</pre>
        <div align="right"><button onclick="execute(this)">Execute</button></div>
        </div>
    
        <div class="codeSample">
        <h3>Open entity list form and hide filter panel</h3>
        <pre class="code">openEntityListForm({
        entityName: 'User', 
        caption: 'Web Site Users',
        hideFilterPanel: true
    });</pre>
        <div align="right"><button onclick="execute(this)">Execute</button></div>
        </div>
    
        <div class="codeSample">
        <h3>Open entity list form and put a command button below the list</h3>
        <pre class="code">openEntityListForm({
        entityName: 'Content', 
        caption: 'Content list with sort facility',
        extraCommands: [
            { id: 'Sort', icon: 'sort', name: 'Sırala', handler: function(arg){alert(JSON.stringify(arg,null,'\t'));} }
        ]
    });</pre>
        <div align="right"><button onclick="execute(this)">Execute</button></div>
        </div>
    
        <div class="codeSample">
        <h3>Open entity list form and hide a category of edit form </h3>
        <pre class="code">openEntityListForm({
        entityName: 'User', 
        caption: 'Web Site Users',
        editFormHideCategory: 'Temel'
    });</pre>
        <div align="right"><button onclick="execute(this)">Execute</button></div>
        </div>
    
        <div class="codeSample">
        <h3>Open entity list form and rename edit form labels</h3>
        <pre class="code">openEntityListForm({
        entityName: 'User', 
        caption: 'Web Site Users',
        renameLabels: {
            Name:'Ünvan',
            Surname:'Ecdat Adı'
        }
    });</pre>
        <div align="right"><button onclick="execute(this)">Execute</button></div>
        </div>
    </div>
    <h1>Performans için önbellek (cache) çözümü</h1>
    <div class="part">
        <ul>
            <li>Çok ziyaretçisi olan sitelerin kaynak kullanımı çok olur.</li>
            <li>Çınar CMS'in en çok kullandığı kaynak veritabanıdır.</li>
            <li>Site ziyaret edildiğinde, her modül veritabanına sorgular gönderir ve çıktıyı oluşturur.</li>
            <li>Önbellek mekanizması veritabanını sorgulama işinin 10 dakikada bir yapılmasını sağlar. Bu süre değiştirilebilir.</li>
            <li>Örneğin saniyede 20 ziyaretçisi olan bir site veritabanına muhtemelen saniyede 200 sorgu gönderecektir. (10 dakikada toplam 120.000 sorgu)</li>
            <li>Önbellek kullanılırsa 120.000 yerine sadece 200 sorgu çalıştırılır.</li>
            <li>Önbellek mekanizması; kullanıcıya özel olmayan modüller için kullanılmalıdır.</li>

        </ul>
    </div>
    </body>
</html>
